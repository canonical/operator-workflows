[32mINFO    [0m pytest_operator.plugin:plugin.py:806 Connecting to existing model github-pr-871f7-microk8s:testing on unspecified cloud
[32mINFO    [0m juju.model:model.py:2631 Waiting for model:
  test (missing)
[32mINFO    [0m juju.model:model.py:1994 Deploying local:jammy/test-upload-0
[32mINFO    [0m juju.model:model.py:2631 Waiting for model:
  test/0 [idle] active:
[32mINFO    [0m pytest_operator.plugin:plugin.py:951 Model status:

Model    Controller                Cloud/Region        Version  SLA          Timestamp
testing  github-pr-871f7-microk8s  microk8s/localhost  2.9.52   unsupported  15:35:42Z

App   Version  Status  Scale  Charm        Channel  Rev  Address         Exposed  Message
test           active      1  test-upload             0  10.152.183.129  no       

Unit     Workload  Agent  Address       Ports  Message
test/0*  active    idle   10.1.243.138         


[32mINFO    [0m pytest_operator.plugin:plugin.py:957 Juju error logs:


[32mINFO    [0m pytest_operator.plugin:plugin.py:1039 Forgetting model main...
[31m[1mERROR   [0m websockets.client:protocol.py:1009 data transfer failed
Traceback (most recent call last):
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 953, in transfer_data
    message = await self.read_message()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1023, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1098, in read_data_frame
    frame = await self.read_frame(max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1155, in read_frame
    frame = await Frame.read(
            ^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/framing.py", line 70, in read
    data = await reader(2)
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/streams.py", line 752, in readexactly
    await self._wait_for_data('readexactly')
  File "/usr/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 1075, in write
    n = self._sock.send(data)
        ^^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor
[33mWARNING [0m juju.client.connection:connection.py:617 RPC: Connection closed, reconnecting
[33mWARNING [0m juju.client.connection:connection.py:543 Receiver: Connection closed, reconnecting
[31m[1mERROR   [0m juju.client.connection:jasyncio.py:67 Task tmp raised an exception: Passing coroutines is forbidden, use tasks explicitly.
Traceback (most recent call last):
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 953, in transfer_data
    message = await self.read_message()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1023, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1098, in read_data_frame
    frame = await self.read_frame(max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1155, in read_frame
    frame = await Frame.read(
            ^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/framing.py", line 70, in read
    data = await reader(2)
           ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/streams.py", line 752, in readexactly
    await self._wait_for_data('readexactly')
  File "/usr/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 1075, in write
    n = self._sock.send(data)
        ^^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py", line 612, in rpc
    await self._ws.send(outgoing)
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 628, in send
    await self.ensure_open()
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 929, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/juju/jasyncio.py", line 55, in _task_result_exp_handler
    task.result()
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py", line 566, in _do_ping
    await pinger_facade.Ping()
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/juju/client/facade.py", line 486, in wrapper
    reply = await f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/juju/client/_client1.py", line 14077, in Ping
    reply = await self.rpc(msg)
            ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/juju/client/facade.py", line 659, in rpc
    result = await self.connection.rpc(msg, encoder=TypeEncoder)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/operator-workflows/operator-workflows/tests/workflows/integration/test-upload-charm/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py", line 622, in rpc
    await jasyncio.wait([self.reconnect()])
  File "/usr/lib/python3.12/asyncio/tasks.py", line 461, in wait
    raise TypeError("Passing coroutines is forbidden, use tasks explicitly.")
TypeError: Passing coroutines is forbidden, use tasks explicitly.